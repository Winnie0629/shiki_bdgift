<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Happy Birthday Shiki</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Arial", sans-serif;
        background: linear-gradient(
          135deg,
          #ffe5e5 0%,
          #e5f5ff 50%,
          #fff9e5 100%
        );
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
      }

      .header {
        text-align: center;
        color: #6b5b7b;
        margin-bottom: 30px;
      }

      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.5);
      }

      .stats {
        display: flex;
        gap: 30px;
        color: #8b7b8b;
        font-size: 1.2em;
        margin-bottom: 20px;
      }

      .game-container {
        display: grid;
        grid-template-columns: repeat(4, 150px);
        gap: 15px;
        perspective: 1000px;
      }

      .card {
        width: 150px;
        height: 150px;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 0.6s;
        cursor: pointer;
      }

      .card:active {
        transform: scale(0.95);
      }

      .card.flip {
        transform: rotateY(180deg);
      }

      .card.matched {
        opacity: 0.6;
        pointer-events: none;
      }

      .card-face {
        width: 100%;
        height: 100%;
        position: absolute;
        border-radius: 15px;
        backface-visibility: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }

      .card-front {
        background: white;
        transform: rotateY(180deg);
        overflow: hidden;
      }

      .card-front img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .card-back {
        background: linear-gradient(135deg, #ffd1dc 0%, #baffc9 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3em;
      }

      .restart-btn {
        margin-top: 30px;
        padding: 15px 40px;
        font-size: 1.2em;
        background: white;
        color: #b8a4c9;
        border: 2px solid #e0bbe4;
        border-radius: 25px;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
        font-weight: bold;
      }

      .restart-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        background: #f8f4f9;
      }

      .win-message {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 40px 60px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        text-align: center;
        display: none;
        z-index: 1000;
      }

      .win-message.show {
        display: block;
        animation: fadeIn 0.5s;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translate(-50%, -40%);
        }
        to {
          opacity: 1;
          transform: translate(-50%, -50%);
        }
      }

      .win-message h2 {
        color: #b8a4c9;
        font-size: 2em;
        margin-bottom: 20px;
      }

      @media (max-width: 768px) {
        .game-container {
          grid-template-columns: repeat(3, 100px);
          gap: 10px;
        }

        .card {
          width: 100px;
          height: 100px;
        }
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Happy Birthday Shiki!</h1>
      <div class="stats">
        <div>翻牌次数: <span id="moves">0</span></div>
        <div>时间: <span id="timer">00:00</span></div>
      </div>
    </div>

    <div class="game-container" id="gameContainer"></div>

    <button class="restart-btn" onclick="restartGame()">重新开始</button>

    <div class="win-message" id="winMessage">
      <h2>恭喜完成！</h2>
      <p>你成功找到了所有配对！</p>
      <p>共用了 <span id="finalMoves"></span> 次翻牌</p>
      <p>用时 <span id="finalTime"></span></p>
      <p>获得奖励兑换卡一张</p>
      <button class="restart-btn" onclick="restartGame()">再玩一次</button>
    </div>

    <script>
      // ⚠️ 重要：替换这里的图片路径为你自己的照片！

      // 如果你的照片在本地，改成这样：
      const imageData = [
        "images/1.jpg",
        "images/2.jpg",
        "images/3.jpg",
        "images/4.jpg",
        "images/5.jpg",
        "images/6.jpg",
        "images/7.jpg",
        "images/8.jpg",
      ];

      let cards = [];
      let flippedCards = [];
      let matchedPairs = 0;
      let moves = 0;
      let startTime;
      let timerInterval;

      function initGame() {
        const gameContainer = document.getElementById("gameContainer");
        gameContainer.innerHTML = "";

        // 创建配对的卡片数组
        cards = [...imageData, ...imageData];

        // 洗牌
        cards.sort(() => Math.random() - 0.5);

        // 创建卡片
        cards.forEach((image, index) => {
          const card = document.createElement("div");
          card.className = "card";
          card.dataset.index = index;
          card.dataset.image = image;

          card.innerHTML = `
                    <div class="card-face card-back"></div>
                    <div class="card-face card-front">
                        <img src="${image}" alt="Memory Card">
                    </div>
                `;

          card.addEventListener("click", flipCard);
          gameContainer.appendChild(card);
        });

        // 重置变量
        flippedCards = [];
        matchedPairs = 0;
        moves = 0;
        document.getElementById("moves").textContent = moves;
        document.getElementById("timer").textContent = "00:00";
        document.getElementById("winMessage").classList.remove("show");

        // 开始计时
        if (timerInterval) clearInterval(timerInterval);
        startTime = Date.now();
        timerInterval = setInterval(updateTimer, 1000);
      }

      function flipCard() {
        if (flippedCards.length >= 2) return;
        if (
          this.classList.contains("flip") ||
          this.classList.contains("matched")
        )
          return;

        this.classList.add("flip");
        flippedCards.push(this);

        if (flippedCards.length === 2) {
          moves++;
          document.getElementById("moves").textContent = moves;
          checkMatch();
        }
      }

      function checkMatch() {
        const [card1, card2] = flippedCards;
        const isMatch = card1.dataset.image === card2.dataset.image;

        if (isMatch) {
          card1.classList.add("matched");
          card2.classList.add("matched");
          matchedPairs++;
          flippedCards = [];

          if (matchedPairs === imageData.length) {
            setTimeout(showWinMessage, 500);
          }
        } else {
          setTimeout(() => {
            card1.classList.remove("flip");
            card2.classList.remove("flip");
            flippedCards = [];
          }, 1000);
        }
      }

      function updateTimer() {
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        const minutes = Math.floor(elapsed / 60)
          .toString()
          .padStart(2, "0");
        const seconds = (elapsed % 60).toString().padStart(2, "0");
        document.getElementById("timer").textContent = `${minutes}:${seconds}`;
      }

      function showWinMessage() {
        clearInterval(timerInterval);
        document.getElementById("finalMoves").textContent = moves;
        document.getElementById("finalTime").textContent =
          document.getElementById("timer").textContent;
        document.getElementById("winMessage").classList.add("show");
      }

      function restartGame() {
        initGame();
      }

      // 初始化游戏
      initGame();
    </script>
  </body>
</html>
